---
layout: guide-base
---
- page.body_class = 'guide'
- page.bottom_javascripts = [ '/javascripts/jquery-scroll.js', 'http://apis.google.com/js/plusone.js' ]
#content{:lang=>page.language ? page.language.code : nil}
  - if page.authors
    .authors<
      %strong= "Contributor#{page.authors.size > 1 ? 's' : ''}:"
      // TODO Link in to site identities
      = ' '.concat(page.authors.map{|u| u} * ', ')
      - if page.translators
        %strong{:style=>'padding-left: 10px;'}= "Translator#{page.translators.size > 1 ? 's' : ''}:"
        = ' '.concat(page.translators.map{|u| site.identities.lookup(u).to_link} * ', ')
        %strong{:style=>'padding-left: 10px;'} Language:
        %img.flag{:src=>page.language.flag_icon, :rel=>'tooltip', :title=>"#{page.language.display_name_local} (#{page.language.code})"}
      - if page.languages
        %strong{:style=>'padding-left: 10px;'} Translations:
        - for translation in page.languages
          - if translation.language != page.guide.language
            %a{ :href=>translation.url }<
              %img.flag{:src=>translation.language.flag_icon, :rel=>'tooltip', :title=>"#{translation.language.display_name_local} (#{translation.language.code})"}
      %br
      - if page.guide.group
        %strong Level:
        = ' '.concat(groups[page.guide.group - 1][1])
      - if page.tags
        %strong{:style=>"padding-left: #{page.guide.group ? 10 : 0}px;"} Tags:
        = ' '.concat(page.tags * ', ')
      %strong{:style=>"padding-left: #{page.guide.group || page.tags ? 10 : 0}px;"} Last Update:
      = ' '.concat(page.guide.changes[0].date.strftime('%b %d, %Y'))
  ~ content
  %h2
    %a#share
      Share the Knowledge
  %p
    Find this guide useful?

  %p.post_to_twitter
    %a{ :href=> "http://twitter.com/home/?status=#{URI.escape("Just read the #jdf #{page.title} guide! Get yours. #{site.base_url}#{page.url}")}" }
      %img{ :src=>"#{site.base_url}/images/post_to_twitter.png" }

  .g-plusone{ 'data-size' => "tall" }

  %h4
    Feedback

  %p
    TODO

  - if page.guide.changes
    %h4 Recent Changelog
    %ul
      - for change in page.guide.changes
        %li
          #{change.date.strftime('%b %d, %Y')}:
          &= change.message
          %em by #{change.author} 
    %p
      -# FIXME make me a function
      %a{:href=>"#{site.website_source_repo}/commits/master#{page.relative_source_path}"} See full history &raquo;
- if page.guide
  #sidebar
    #toc
      %h3.chapter_header Section
      %ol.chapters
        - page.guide.chapters.each do |chapter|
          %li
            %a{:id=>"#{chapter.link_id}_link", :href=>"##{chapter.link_id}"}= chapter.text
  %script
    $(window).load(function() { activateScrollingToc([#{page.guide.chapters.map{|c| "'#{c.link_id}'"} * ', '}]) })
